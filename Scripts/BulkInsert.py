# https://stackoverflow.com/questions/37471803/sql-server-maximum-rows-that-can-be-inserted-in-a-single-insert-statment

import pyodbc
import pandas as pd

server = 'DESKTOP-F5DJ1U5'
database = 'TestDB'
conn = pyodbc.connect('Driver={SQL Server};''server=' + server + ';database=' + database + ';Trusted_Connection=yes;')
cursor = conn.cursor()

df = pd.read_csv("CSV/big.csv")
q = df.to_numpy().tolist()
values = ", ".join(str(tuple(x)) for x in q)

# print(str(tuple_of_tuples))
# command = '''WITH NewData AS (SELECT * FROM ( VALUES (1.0, 1180.0, 5650.0, 1.0), (2.25, 2570.0, 7242.0, 2.0), (1.0,
# 770.0, 10000.0, 1.0), (3.0, 1960.0, 5000.0, 1.0), (2.0, 1680.0, 8080.0, 1.0), (4.5, 5420.0, 101930.0, 1.0), (2.25,
# 1715.0, 6819.0, 2.0), (1.5, 1060.0, 9711.0, 1.0), (1.0, 1780.0, 7470.0, 1.0), (2.5, 1890.0, 6560.0, 2.0), (2.5,
# 3560.0, 9796.0, 1.0), (1.0, 1160.0, 6000.0, 1.0), (1.0, 1430.0, 19901.0, 1.5), (1.75, 1370.0, 9680.0, 1.0), (2.0,
# 1810.0, 4850.0, 1.5), (3.0, 2950.0, 5000.0, 2.0), (2.0, 1890.0, 14040.0, 2.0), (1.0, 1600.0, 4300.0, 1.5), (1.0,
# 1200.0, 9850.0, 1.0), (1.0, 1250.0, 9774.0, 1.0), (1.75, 1620.0, 4980.0, 1.0), (2.75, 3050.0, 44867.0, 1.0), (2.5,
# 2270.0, 6300.0, 2.0), (1.5, 1070.0, 9643.0, 1.0), (2.25, 2450.0, 6500.0, 2.0), (2.0, 1710.0, 4697.0, 1.5), (1.75,
# 2450.0, 2691.0, 2.0), (1.0, 1400.0, 1581.0, 1.5), (1.75, 1520.0, 6380.0, 1.0), (2.5, 2570.0, 7173.0, 2.0), (2.5,
# 2320.0, 3980.0, 2.0), (1.5, 1190.0, 1265.0, 3.0), (1.75, 2330.0, 5000.0, 1.5), (1.0, 1090.0, 3000.0, 1.5), (2.75,
# 2060.0, 6659.0, 1.0), (2.5, 2300.0, 3060.0, 1.5), (1.0, 1660.0, 34848.0, 1.0), (2.0, 2360.0, 6000.0, 2.0), (1.0,
# 1220.0, 8075.0, 1.0), (2.5, 2620.0, 7553.0, 2.0), (2.5, 2570.0, 5520.0, 2.0), (2.25, 4220.0, 24186.0, 1.0), (2.75,
# 3595.0, 5639.0, 2.0), (1.0, 1570.0, 2280.0, 2.0), (1.0, 1280.0, 9656.0, 1.0), (2.5, 3160.0, 13603.0, 2.0), (1.0,
# 990.0, 8528.0, 1.0), (2.5, 2290.0, 13416.0, 2.0), (1.75, 1250.0, 5963.0, 1.0), (2.5, 2753.0, 65005.0, 1.0), (1.0,
# 1190.0, 9199.0, 1.0), (2.5, 3150.0, 9134.0, 1.0), (1.75, 1410.0, 4080.0, 1.0), (1.75, 1980.0, 8550.0, 1.0), (2.25,
# 2730.0, 6000.0, 1.5), (2.5, 2830.0, 5000.0, 2.0), (2.5, 2250.0, 4495.0, 2.0), (2.5, 2420.0, 4750.0, 2.0), (3.25,
# 3250.0, 14342.0, 2.0), (3.0, 1850.0, 9976.0, 2.0), (2.25, 2150.0, 21235.0, 1.0), (1.75, 1260.0, 8400.0, 1.0),
# (1.75, 2519.0, 8690.0, 2.0), (1.75, 1540.0, 1044.0, 3.0), (2.25, 1660.0, 6000.0, 1.0), (2.75, 2770.0, 3809.0, 1.5),
# (2.5, 2720.0, 11049.0, 2.0), (2.5, 2240.0, 4648.0, 2.0), (1.0, 1000.0, 12070.0, 1.0), (2.25, 3200.0, 20158.0, 1.0),
# (3.25, 4770.0, 50094.0, 1.0), (2.0, 1260.0, 5612.0, 1.0), (2.0, 2750.0, 7807.0, 1.5), (2.5, 2380.0, 5000.0, 2.0),
# (1.75, 1790.0, 50529.0, 1.0), (4.0, 3430.0, 35102.0, 2.0), (1.75, 1760.0, 7300.0, 1.0), (1.0, 1040.0, 5060.0, 1.0),
# (1.0, 1410.0, 5060.0, 1.0), (2.5, 3450.0, 39683.0, 2.0), (2.5, 2350.0, 5100.0, 2.0), (2.5, 1900.0, 5889.0, 2.0),
# (1.0, 2020.0, 6720.0, 1.0), (1.5, 1680.0, 8712.0, 1.0), (1.0, 960.0, 6634.0, 1.0), (1.5, 2140.0, 3600.0, 2.0),
# (2.25, 2660.0, 8400.0, 1.5), (3.25, 2770.0, 6278.0, 2.0), (2.25, 1610.0, 2040.0, 2.0), (1.75, 1030.0, 1066.0, 2.0),
# (2.5, 1980.0, 7403.0, 2.0), (2.75, 3520.0, 6353.0, 2.0), (1.0, 1200.0, 10500.0, 1.0), (1.5, 1580.0, 5000.0, 1.0),
# (1.5, 1580.0, 5000.0, 1.0), (2.5, 3300.0, 10250.0, 1.0), (1.75, 1960.0, 15681.0, 1.0), (1.5, 1160.0, 6400.0, 1.0),
# (1.75, 1810.0, 41800.0, 1.0), (2.5, 2320.0, 36847.0, 2.0), (2.5, 2070.0, 13241.0, 1.5), (2.0, 1980.0, 3478.0, 1.5),
# (2.25, 2190.0, 107593.0, 2.0), (2.5, 2920.0, 8113.0, 2.0), (1.0, 1210.0, 33919.0, 1.0), (2.5, 2340.0, 10005.0,
# 1.0), (1.0, 1670.0, 4005.0, 1.5), (1.75, 1240.0, 2493.0, 1.0), (2.5, 3140.0, 28037.0, 2.0), (1.75, 2030.0, 12342.0,
# 2.0), (2.5, 2310.0, 9624.0, 2.0), (1.75, 1260.0, 3328.0, 1.0), (1.75, 1540.0, 12600.0, 1.0), (1.75, 2080.0, 5969.0,
# 1.0), (2.5, 3230.0, 16171.0, 2.0), (3.5, 4380.0, 6350.0, 2.0), (3.5, 1590.0, 1102.0, 3.0), (1.0, 880.0, 6780.0,
# 1.0), (2.0, 1570.0, 9600.0, 1.0), (1.0, 1610.0, 2982.0, 1.5), (2.5, 2400.0, 6474.0, 1.0), (2.0, 1450.0, 9132.0,
# 1.0), (1.0, 770.0, 6000.0, 1.0), (1.75, 2100.0, 4400.0, 1.5), (2.25, 2910.0, 10204.0, 2.0), (2.75, 2750.0, 17789.0,
# 1.5), (2.25, 2100.0, 8201.0, 1.0), (2.25, 2160.0, 8811.0, 1.0), (3.5, 2320.0, 4960.0, 2.0), (2.5, 2070.0, 4310.0,
# 2.0), (1.75, 1060.0, 7875.0, 1.0), (2.25, 2010.0, 9603.0, 1.0), (3.5, 3950.0, 111078.0, 1.5), (2.5, 2010.0, 2287.0,
# 2.0), (3.5, 2140.0, 2278.0, 3.0), (1.75, 1320.0, 17390.0, 1.0), (1.75, 2020.0, 7840.0, 1.0), (2.25, 2590.0,
# 10002.0, 1.0), (1.0, 1190.0, 4440.0, 1.0), (2.25, 1170.0, 1249.0, 3.0), (1.0, 1110.0, 3200.0, 1.0), (2.5, 2820.0,
# 9375.0, 1.0), (1.0, 1610.0, 8579.0, 1.0), (1.0, 1060.0, 8097.0, 1.0), (2.25, 2030.0, 8517.0, 1.0), (2.5, 3670.0,
# 315374.0, 2.0), (1.0, 2550.0, 4000.0, 2.0), (2.5, 2420.0, 60984.0, 2.0), (2.0, 2260.0, 12500.0, 1.0), (1.0, 1430.0,
# 3455.0, 1.0), (2.0, 1360.0, 3090.0, 2.0), (1.0, 1110.0, 5000.0, 1.5), (1.0, 1250.0, 8200.0, 1.0), (3.25, 5180.0,
# 19850.0, 2.0), (1.0, 700.0, 5100.0, 1.0), (1.0, 1180.0, 7669.0, 1.0), (3.5, 3960.0, 25245.0, 2.0), (2.75, 2640.0,
# 7500.0, 1.0), (2.0, 1270.0, 7198.0, 1.5), (1.75, 1760.0, 11180.0, 1.0), (2.25, 2060.0, 8632.0, 1.0), (1.75, 1780.0,
# 9660.0, 1.0), (2.5, 3400.0, 16603.0, 2.0), (2.75, 1910.0, 7280.0, 1.0), (2.0, 2020.0, 38332.0, 1.0), (1.75, 1580.0,
# 7000.0, 1.0), (1.75, 1340.0, 7250.0, 1.0), (2.5, 2680.0, 4499.0, 2.0), (2.5, 2680.0, 9750.0, 1.0), (2.0, 1370.0,
# 8336.0, 1.0), (1.75, 1560.0, 21000.0, 1.0), (1.75, 2160.0, 7140.0, 1.0), (1.5, 1340.0, 7912.0, 1.5), (2.5, 3880.0,
# 35003.0, 2.0), (2.25, 2590.0, 8190.0, 2.0), (2.5, 1120.0, 1100.0, 2.0), (2.75, 1970.0, 5400.0, 1.0), (1.0, 1220.0,
# 4800.0, 1.0), (1.5, 1950.0, 7560.0, 1.0), (1.0, 1350.0, 8220.0, 1.0), (2.5, 1670.0, 5797.0, 2.0), (3.0, 2380.0,
# 5125.0, 1.5), (3.0, 2440.0, 9600.0, 2.0), (1.5, 1050.0, 3419.0, 2.0), (2.75, 3130.0, 13412.0, 2.0), (3.0, 4090.0,
# 12850.0, 1.0), (1.75, 1490.0, 10000.0, 1.0), (2.5, 1900.0, 8744.0, 2.0), (1.0, 1330.0, 2400.0, 1.5), (2.25, 2230.0,
# 10026.0, 1.0), (1.75, 1650.0, 9480.0, 1.0), (1.0, 1190.0, 8820.0, 1.0), (2.5, 2140.0, 9897.0, 1.0), (2.5, 2180.0,
# 7508.0, 1.0), (1.0, 1060.0, 10228.0, 1.0), (2.5, 1690.0, 5025.0, 2.0), (2.0, 1970.0, 6480.0, 1.5), (2.5, 2150.0,
# 4084.0, 2.0), (2.5, 1910.0, 66211.0, 2.0), (1.75, 1350.0, 155073.0, 1.0), (1.0, 860.0, 11725.0, 1.0), (2.5, 1940.0,
# 14952.0, 2.0), (1.0, 1010.0, 5000.0, 1.0), (1.5, 1300.0, 7370.0, 1.0), (1.0, 910.0, 8450.0, 1.0), (1.75, 2480.0,
# 11010.0, 1.0), (2.5, 2440.0, 4587.0, 2.0), (1.0, 1010.0, 5864.0, 1.0), (0.75, 900.0, 9600.0, 1.0), (3.0, 2300.0,
# 3404.0, 2.0), (2.25, 1550.0, 7579.0, 2.0), (2.25, 1270.0, 1566.0, 2.0), (2.5, 2240.0, 12032.0, 1.0), (2.5, 2714.0,
# 17936.0, 2.0), (2.75, 1720.0, 6270.0, 2.0), (1.0, 850.0, 16400.0, 1.0), (3.0, 3300.0, 33474.0, 1.0), (2.5, 2250.0,
# 5692.0, 2.0), (2.25, 3900.0, 14864.0, 1.0), (1.5, 1320.0, 10800.0, 1.0), (2.5, 2760.0, 6440.0, 2.0), (2.0, 1750.0,
# 9750.0, 1.0), (2.25, 2330.0, 19436.0, 2.0), (2.25, 2220.0, 16020.0, 1.0), (2.25, 2020.0, 8379.0, 2.0), (2.25,
# 1250.0, 7500.0, 1.0), (2.0, 1510.0, 6516.0, 1.0), (2.25, 1720.0, 9753.0, 1.0), (1.0, 1430.0, 15246.0, 1.0), (2.5,
# 1480.0, 4729.0, 2.0), (1.75, 1450.0, 15798.0, 2.0), (2.75, 2280.0, 15347.0, 1.0), (2.75, 2940.0, 7350.0, 1.0),
# (1.0, 1000.0, 10200.0, 1.0), (1.5, 2480.0, 5280.0, 1.5), (4.0, 3760.0, 28040.0, 2.0), (2.0, 2220.0, 94300.0, 1.0),
# (1.0, 1970.0, 4740.0, 1.5), (3.5, 3830.0, 221284.0, 2.0), (2.5, 4410.0, 14034.0, 1.0), (1.75, 1430.0, 8505.0, 1.0),
# (1.0, 830.0, 6000.0, 1.0), (1.0, 1430.0, 5000.0, 1.5), (1.0, 1300.0, 8316.0, 1.0), (1.0, 1030.0, 3060.0, 1.0),
# (2.5, 2740.0, 11872.0, 2.0), (2.5, 3650.0, 8354.0, 1.0), (1.5, 720.0, 5120.0, 1.0), (2.0, 2010.0, 7312.0, 1.0),
# (1.75, 1560.0, 3000.0, 1.0), (2.0, 1810.0, 7209.0, 1.0), (2.5, 3360.0, 7685.0, 2.0), (2.25, 1510.0, 36224.0, 2.0),
# (1.0, 1400.0, 3538.0, 1.0), (2.5, 1730.0, 7442.0, 2.0), (2.0, 1420.0, 9191.0, 1.5), (1.75, 2360.0, 7620.0, 1.0),
# (1.75, 1580.0, 11455.0, 1.0), (1.0, 1230.0, 10170.0, 1.0), (2.5, 2460.0, 4425.0, 2.0), (1.0, 1660.0, 4400.0, 1.5),
# (1.75, 1270.0, 8470.0, 1.0), (2.25, 2100.0, 40510.0, 2.0), (1.0, 770.0, 5040.0, 1.0), (0.75, 760.0, 10079.0, 1.0),
# (2.5, 1700.0, 7280.0, 2.0), (1.0, 1120.0, 10701.0, 1.0), (1.0, 1070.0, 4500.0, 1.0), (2.5, 2070.0, 9900.0, 1.0),
# (3.25, 5050.0, 20100.0, 1.5), (4.75, 5310.0, 57346.0, 2.0), (1.0, 1040.0, 7538.0, 1.0), (1.0, 1700.0, 11390.0,
# 1.0), (1.0, 1300.0, 5898.0, 1.0), (1.75, 1080.0, 1306.0, 1.0), (2.5, 2653.0, 4510.0, 2.0), (2.0, 2290.0, 16258.0,
# 1.0), (2.75, 3820.0, 26300.0, 2.0), (2.5, 2210.0, 49375.0, 1.0), (1.75, 2390.0, 6000.0, 1.0), (1.75, 2600.0,
# 11325.0, 1.0), (1.0, 860.0, 5265.0, 1.0), (3.0, 3830.0, 8480.0, 2.0), (2.5, 3500.0, 7048.0, 2.0), (3.0, 2420.0,
# 13959.0, 1.0), (2.5, 2720.0, 8666.0, 2.0), (2.25, 2500.0, 13500.0, 1.0), (1.75, 1670.0, 6720.0, 1.0), (2.25,
# 2900.0, 10300.0, 1.0), (1.0, 1640.0, 14100.0, 1.0), (2.5, 1890.0, 15770.0, 2.0), (1.75, 2950.0, 9025.0, 1.0), (2.5,
# 2160.0, 9528.0, 2.0), (3.0, 3280.0, 11060.0, 2.0), (2.0, 1970.0, 4166.0, 2.0), (2.5, 3360.0, 22111.0, 2.0), (2.0,
# 1320.0, 8959.0, 1.0), (2.5, 2650.0, 7286.0, 2.0), (1.5, 2030.0, 8880.0, 1.0)) x (A,B,C,D)) INSERT INTO BULK (
# bathrooms,sqft_living,sqft_lot,floors) SELECT A,B,C,D FROM NewData'''

command = "WITH NewData AS (SELECT * FROM (VALUES %s) x (A,B,C,D)) INSERT INTO TestDB.dbo.FromPython2 (num1,num2," \
          "num3,num4) SELECT A,B,C,D FROM NewData" % str(values)
# print(command)
cursor.execute(command)
conn.commit()
